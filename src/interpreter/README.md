# Interpreterパターン

## Interpreterパターンとは
Interpreterパターンは、特定の言語の文法を表現し、その文法に基づいて文を解釈するためのデザインパターンです。文法をオブジェクトとして表現し、文を解釈するためのインタプリタを提供します。

## 目的
- 特定の言語の文法をオブジェクトとして表現する
- 文法に基づいて文を解釈する
- 文法の変更や拡張を容易にする

## メリット・デメリット

### メリット
- 文法の変更や拡張が容易（新しい演算を追加しやすい）
- 文法をオブジェクトとして表現することで、柔軟な文の解釈が可能
- 構文解析や評価の仕組みを統一できる

### デメリット
- 文法が複雑になると、クラス数が増加する
- パフォーマンスが低下する可能性がある
- 大規模な言語解析には向かない（複雑な文法はパフォーマンスが悪くなる）

## 主なユースケース（具体的に）

1. **SQLクエリの解析**
   - SQL文を解析し、実行する
   - SQL パーサー、正規表現エンジン
   - 例：データベースクエリの解析と実行

2. **スクリプトの実行**
   - 数式を解析し、計算する
   - DSL（ドメイン固有言語）
   - 例：電卓アプリケーション

3. **プログラミング言語のインタプリタ**
   - プログラムコードを解析し、実行する
   - 例：スクリプト言語のインタプリタ

4. **構文解析**
   - 文法に基づいて文を解析する
   - ビジネスルールの評価（if 条件式を解釈）
   - 例：コンパイラの構文解析

## 実装例の説明
このサンプルコードでは、以下のような構造でInterpreterパターンを実装しています：

1. **Expression（インターフェース）**
   - 全ての式が実装するインターフェース
   - interpret()メソッドを定義

2. **ConcreteExpression（具象クラス）**
   - 具体的な式を実装
   - NumberExpression, AddExpression, SubtractExpression

3. **Context（コンテキスト）**
   - 式の解釈に必要な情報を保持するクラス

## よくある質問（FAQ）

### Q: InterpreterパターンとVisitorパターンの違いは何ですか？
A: Interpreterパターンは文法をオブジェクトとして表現し、文を解釈するのに対し、Visitorパターンはオブジェクト構造を巡回し、操作を実行するためのパターンです。

### Q: Interpreterパターンはいつ使用すべきですか？
A: 以下のような場合に使用すべきです：
- 特定の言語の文法をオブジェクトとして表現したい場合
- 文法に基づいて文を解釈したい場合
- 文法の変更や拡張を容易にしたい場合

### Q: 実際のプログラムで Interpreter パターンを使うことは多い？
A: 実際のプログラムでは、複雑な解析には「パーサーコンパイラ」を使うことが多い。ANTLR（構文解析ライブラリ）や正規表現の方が便利な場合が多い。ただし、小規模なルールやフィルタには適用しやすい。

### Q: Interpreterパターンの実装コストは高いですか？
A: 文法が複雑になるとクラス数が増加し、実装コストが高くなる可能性がありますが、文法の変更や拡張が容易になるため、長期的にはコストを回収できる場合があります。 