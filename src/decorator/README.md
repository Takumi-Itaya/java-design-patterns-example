# Decorator パターン

## Decorator パターンとは

Decorator パターンは、オブジェクトに動的に新しい機能を追加するためのデザインパターンです。サブクラスを作成する代わりに、デコレータークラスを使用して機能を追加することで、より柔軟な拡張が可能になります。

## 目的

- オブジェクトに動的に新しい機能を追加する
- サブクラスによる拡張の代わりに、デコレーターを使用して機能を追加する
- 単一責任の原則に従いながら、機能を追加する

## メリット・デメリット

### メリット

- オブジェクトに動的に機能を追加できる
- サブクラスによる拡張よりも柔軟
- 単一責任の原則に従いやすい
- 既存のコードを変更せずに機能を追加できる

### デメリット

- デコレーターの階層構造が複雑になる可能性がある
- デコレーターの順序が重要になる場合がある
- オブジェクトの数が増加し、メモリ使用量が増える

## 主なユースケース

1. **GUI コンポーネント**

   - ウィンドウにスクロールバー、ボーダー、タイトルバーなどを追加
   - 例：Java Swing の JScrollPane、JPanel などのコンポーネント

2. **ストリーム処理**

   - 入出力ストリームに圧縮、暗号化、バッファリングなどの機能を追加
   - 例：Java IO の BufferedReader、GZIPInputStream など

3. **飲料メニュー**

   - 基本の飲み物に様々なトッピングを追加
   - 例：コーヒーショップのメニューシステム

4. **ログ機能**

   - 基本的なログ機能に、タイムスタンプ、ログレベル、ファイル出力などの機能を追加
   - 例：ロギングフレームワーク

5. **Web フィルター**

- HTTP リクエストに対して 「ログ記録」「圧縮」「認証」などの機能を追加する

## 実装例の説明

このサンプルコードでは、以下のような構造で Decorator パターンを実装しています：

1. **Component（Beverage）**

   - 飲み物の基本インターフェース
   - 共通の操作（getDescription, cost）を定義

2. **ConcreteComponent（Coffee, Tea）**

   - 具体的な飲み物クラス
   - 基本的な機能を実装

3. **Decorator（BeverageDecorator）**

   - デコレーターの抽象クラス
   - 基本のデコレーター機能を実装

4. **ConcreteDecorator（Milk, Sugar, Lemon）**
   - 具体的なデコレータークラス
   - 特定の機能を追加

## よくある質問（FAQ）

### Q: Decorator パターンと Composite パターンの違いは何ですか？

A: Decorator パターンは単一のオブジェクトに機能を追加することを目的とし、Composite パターンはオブジェクトの階層構造を表現することを目的とします。

### Q: Decorator パターンはいつ使用すべきですか？

A: 以下のような場合に使用すべきです：

- オブジェクトに動的に機能を追加する必要がある場合
- サブクラスによる拡張が適切でない場合
- 機能の組み合わせが多数ある場合

### Q: Decorator パターンの実装コストは高いですか？

A: 初期の設計と実装には若干のコストがかかりますが、長期的な保守性と拡張性の向上により、そのコストは十分に回収できます。特に、システムの規模が大きくなるほど、そのメリットは顕著になります。
