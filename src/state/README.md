# Stateパターン

## Stateパターンとは
Stateパターンは、オブジェクトの内部状態に応じて異なる振る舞いを実現するデザインパターンです。オブジェクトの状態を別々のクラスとして表現し、状態の変更に応じてオブジェクトの振る舞いを変更します。

## 目的
- オブジェクトの内部状態に応じて異なる振る舞いを実現する
- 条件分岐を減らし、コードの可読性を向上させる
- 状態の追加や変更を容易にする
- オブジェクトの状態遷移を明確にする

## メリット・デメリット

### メリット
- 状態に応じた振る舞いを明確に分離できる
- 条件分岐を減らし、コードの可読性が向上する
- 新しい状態の追加が容易
- 状態遷移のロジックが明確になる

### デメリット
- クラスの数が増加する
- 状態の数が多い場合、実装が複雑になる
- 状態間の遷移が複雑になる可能性がある

## 主なユースケース（具体的に）

1. **自動販売機**
   - お金なし、お金あり、在庫切れなどの状態管理
   - 各状態に応じた操作の制御

2. **ドキュメントエディタ**
   - 編集モード、プレビューモード、印刷モードなどの状態管理
   - 各モードに応じた操作の制御

3. **ゲームキャラクター**
   - 通常、攻撃、防御、死亡などの状態管理
   - 各状態に応じた行動の制御

4. **ネットワーク接続**
   - 未接続、接続中、接続済み、切断中などの状態管理
   - 各状態に応じた通信処理の制御

5. **ATMの取引状態**
   - カード挿入、PIN入力、取引中、終了など

## 実装例の説明
このサンプルコードでは、以下のような構造でStateパターンを実装しています：

1. **State（インターフェース）**
   - 状態のインターフェース
   - 各状態で実装すべきメソッドを定義

2. **ConcreteState（具象クラス）**
   - 具体的な状態を実装
   - NoMoneyState、HasMoneyState、SoldOutState

3. **Context（文脈クラス）**
   - 状態を保持するクラス
   - VendingMachineクラス

## よくある質問（FAQ）

### Q: StateパターンとStrategyパターンの違いは何ですか？
A: Stateパターンは内部状態に応じて振る舞いを変更するのに対し、Strategyパターンは実行時にアルゴリズムを切り替えます。

### Q: Stateパターンはいつ使用すべきですか？
A: 以下のような場合に使用すべきです：
- オブジェクトの状態に応じて異なる振る舞いが必要な場合
- 条件分岐が複雑になっている場合
- 状態の追加や変更が頻繁に行われる場合

### Q: Stateパターンの実装コストは高いですか？
A: クラスの数が増加し、実装が複雑になる可能性がありますが、コードの保守性と拡張性が向上するため、長期的にはコストを回収できる場合があります。 