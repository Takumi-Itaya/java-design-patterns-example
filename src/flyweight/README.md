# Flyweight パターン

## Flyweight パターンとは

Flyweight パターンは、大量のオブジェクトを効率的に共有するためのデザインパターンです。共通の状態を共有することで、メモリ使用量を削減し、パフォーマンスを向上させます。

## 目的

- 大量のオブジェクトを効率的に共有する
- メモリ使用量を削減する
- パフォーマンスを向上させる

## メリット・デメリット

### メリット

- メモリ使用量を大幅に削減できる（オブジェクトの重複を防ぐ）
- オブジェクトの生成コストを削減できる（使い回しによる最適化）
- システムのパフォーマンスが向上する（GC 負荷の軽減）

### デメリット

- 実装が複雑になる
- 共有状態と非共有状態の管理が必要
- デバッグが困難になる可能性がある

## 主なユースケース（具体的に）

1. **テキストエディタ**

   - 文字オブジェクトの共有
   - 例：文字の表示、フォント管理

2. **ゲーム開発**

   - 地形やオブジェクトの共有
   - 例：タイルマップ、キャラクタースプライト

3. **GUI アプリケーション**

   - UI コンポーネントの共有
   - 例：アイコン、ボタン、ラベル

4. **ドキュメント処理**
   - 文字や記号の共有
   - 例：PDF レンダリング、ワードプロセッサ

## 実装例の説明

このサンプルコードでは、以下のような構造で Flyweight パターンを実装しています：

1. **Flyweight（Character）**

   - 文字の基本インターフェース
   - 共通の操作（display）を定義

2. **ConcreteFlyweight（ConcreteCharacter）**

   - 具体的な文字クラス
   - 内部状態（symbol）を持つ

3. **FlyweightFactory（CharacterFactory）**
   - 文字オブジェクトの生成と管理
   - 文字の再利用を実現

## よくある質問（FAQ）

### Q: Flyweight パターンと Singleton パターンの違いは何ですか？

A: Flyweight パターンは複数のオブジェクトを共有することを目的とし、Singleton パターンは単一のオブジェクトを共有することを目的とします。

### Q: Flyweight パターンはいつ使用すべきですか？

A: 以下のような場合に使用すべきです：

- 大量のオブジェクトを扱う必要がある場合
- メモリ使用量を削減する必要がある場合
- オブジェクトの生成コストが高い場合

### Q: Flyweight パターンの実装コストは高いですか？

A: 初期の設計と実装には若干のコストがかかりますが、メモリ使用量の削減とパフォーマンスの向上により、そのコストは十分に回収できます。特に、システムの規模が大きくなるほど、そのメリットは顕著になります。
